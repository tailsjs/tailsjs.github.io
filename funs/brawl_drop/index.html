<html>
<head>
<title> блог успешного кодера tailsjs</title>
<meta name="description" content="блог успешного кодера tailsjs коэфециент выпадения бравлера."> 
<meta name="Keywords" content="tailsjs, блог, успешный блог, tailsjs js, js, javascript, блог tailsjs, tailsjs блог"> 
<link rel="icon" href="https://tailsjs.github.io/favicon.ico" type="image/x-icon">
<link rel ="stylesheet" href="style.css">
</head>
<body style="font-family: 'Segoe UI', Tahoma, sans-serif; font-size: 75%">
<a href="../index.html" class="back"><font size="12" style="font-family: 'Aqum'"><= back</font></a><p style="font-family: 'Hack';color: #fff !important;  font-size: 48px;transform: translate(-50%, -50%);position: absolute;text-align: center;left: 50%;top: -1%;">tailsjs</p>
<center><font size="96" color="white" style="font-family: 'Aqum'">Brawl Drop</font></center>
<br>

<canvas id="canvas" width="960" height="540" style="border: white;border-style: solid;-moz-box-sizing: border-box;box-sizing: border-box;transform: translate(-50%, -50%);position: absolute;left: 70%;top: 50%;"></canvas>
<!-- <input value="Download as PNG!" download="tailsjs.ml_breaknews.jpg" href="" onclick="download_img(this, 'jpg');" type="button" style="transform: translate(-50%, -50%);position: absolute;left: 70%;top: 80%;">
<input value="Download as JPG!" download="tailsjs.ml_breaknews.png" href="" onclick="download_img(this, 'png');" type="button" style="transform: translate(-50%, -50%);position: absolute;left: 70%;top: 85%;"> -->
<div class="settings" style="font-family: 'Aqum'">
	<center><font size="96">SETTINGS</font></center></br>
	<center>Rarity: <select id="choice">
		<option value="1" selected>Trophy Road</option>
		<option value="2">Rare</option>
		<option value="3">Super Rare</option>
		<option value="4">Epic</option>
		<option value="5">Mythic</option>
		<option value="6">Legendary</option>
	  </select></center>
	<center>Character Name: <input id="text"></center>
	<center>Description: <input id="desc"></center>
	<center>Image: <input type="file" id="inp" required accept=".jpg, .jpeg, .png"></center></br>
	<center><input value="Create!" id="create" type="button"></center></br>
</div>
<script> // X 230 Y 425
	let img;
	imgX = 0,
	imgY = 0
document.getElementById('inp').onchange = function(e) {
	img = new Image();
	img.src = URL.createObjectURL(this.files[0]);
	img.onload = function(){
		imgX = img.width
		imgY = img.height
	}
};
function draw() {
	
if(imgX === 0 || imgY === 0)return alert("You forgot to attach an image!")


	var text = document.getElementById('text').value.slice(0,14);
	if(!text)return alert("Where's character name?")
	var desc = document.getElementById('desc').value;
	if(!desc)return alert("Where's character description?")
	var canvas = document.getElementById('canvas');
	var ctx = canvas.getContext('2d');
	var img2 = new Image();
	img2.src = "resources/"+["no", "road", "rare", "superrare", "epic", "mythic", "legendary"][Number(document.getElementById('choice').value)]+".png"
	img2.onload = function(){
	ctx.drawImage(img2, 0, 0);
	ctx.font = '48px Pusia';
			ctx.fillStyle = "white";
			ctx.textAlign = 'center';
			ctx.textBaseline = "middle";
			ctx.fillText(text, 670, 197);
			var link2 = document.createElement('link');
				link2.rel = 'stylesheet';
				link2.type = 'text/css';
				link2.href = 'https://github.com/tailsjs/tailsjs.github.io/raw/master/fonts/lilitaone/style.css';
			let c_end = random(3,15)
			ctx.font = '24px Lilita One Regular';
			ctx.fillStyle = ["#FFFFFF", "rgb(122, 190, 236)", "rgb(43, 214, 28)","rgb(11, 97, 235)","rgb(150, 97, 236)", "rgb(235, 27, 21)","rgb(250, 233, 38)"][Number(document.getElementById('choice').value)];
			ctx.fillText(random(1,c_end) + "/" + c_end + " " + ["pwned", "Trophy Road", "Rare", "Super Rare", "Epic", "Mythic", "Legendary"][Number(document.getElementById('choice').value)] + " Brawlers", 677, 233);
			height = 280
l = desc.match(new RegExp(`.{0,26}`, "g"))
do{
l.pop()
}while(l.length > 5)
r = desc.match(new RegExp(`.{0,${26+(l.length-1)}}`, "g"))
do{
r.pop()
}while(r.length > 5)
if(r[r.length-1] === "")m.pop()
console.log(r)
ctx.font = 24-r.length+3 + 'px Pusia';
ctx.fillStyle = "rgb(121, 247, 255)";
for(let i = 0; i < Math.round(r.length/2); i++){
height -= 15-(1*i)
}
			for (var i = 0; i<r.join('\n').split('\n').length; i++)
    ctx.fillText(r.join('\n').split('\n')[i], 672, height+=22-r.length );
if(imgX > 300){imgX=300}
if(imgY > 400){imgY=400}
	ctx.drawImage(img, 230-(imgX/2), 425-imgY, imgX, imgY)
}}
  
function failed() {
	return alert('Это не картинка!')
}
document.getElementById('create').addEventListener('click', draw);
function random(min, max) {return Math.round(Math.random() * (max - min)) + min}
</script>
<canvas id='blank' style='display:none'></canvas>
</body>
</html>
